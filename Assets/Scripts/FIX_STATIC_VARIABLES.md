# üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–±–ª–µ–º–∞ —Å static –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏

## üêõ –ü—Ä–æ–±–ª–µ–º–∞:
–í Unity Multiplayer Play Mode –∫–∞–∂–¥—ã–π —ç–∫–∑–µ–º–ø–ª—è—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–º –¥–æ–º–µ–Ω–µ. Static –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç –º–µ–∂–¥—É —ç–∫–∑–µ–º–ø–ª—è—Ä–∞–º–∏ - –∫–∞–∂–¥—ã–π –≤–∏–¥–∏—Ç —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏.

## üîç –ü–æ—á–µ–º—É static –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç:
```
–≠–∫–∑–µ–º–ø–ª—è—Ä 1: static hasActiveHost = true  
–≠–∫–∑–µ–º–ø–ª—è—Ä 2: static hasActiveHost = false ‚ùå (–Ω–µ –≤–∏–¥–∏—Ç –¥–∞–Ω–Ω—ã–µ —ç–∫–∑–µ–º–ø–ª—è—Ä–∞ 1)
```

## ‚úÖ –†–µ—à–µ–Ω–∏–µ: PlayerPrefs –≤–º–µ—Å—Ç–æ static

### –ë—ã–ª–æ (–Ω–µ —Ä–∞–±–æ—Ç–∞–ª–æ):
```csharp
private static bool hasActiveHost = false;
private static string hostIP = "";

// –ö–∞–∂–¥—ã–π —ç–∫–∑–µ–º–ø–ª—è—Ä –∏–º–µ–µ—Ç —Å–≤–æ–∏ static –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
```

### –°—Ç–∞–ª–æ (—Ä–∞–±–æ—Ç–∞–µ—Ç):
```csharp
// –ö–ª—é—á–∏ –¥–ª—è PlayerPrefs (shared –º–µ–∂–¥—É —ç–∫–∑–µ–º–ø–ª—è—Ä–∞–º–∏)
private const string HOST_ACTIVE_KEY = "MultiplayerTest_HasActiveHost";
private const string HOST_IP_KEY = "MultiplayerTest_HostIP";  
private const string HOST_PORT_KEY = "MultiplayerTest_HostPort";

// –ú–µ—Ç–æ–¥—ã –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ shared –¥–∞–Ω–Ω—ã–º
private bool HasActiveHost() {
    return PlayerPrefs.GetInt(HOST_ACTIVE_KEY, 0) == 1;
}

private void SetHostData(string ip, int port) {
    PlayerPrefs.SetInt(HOST_ACTIVE_KEY, 1);
    PlayerPrefs.SetString(HOST_IP_KEY, ip);
    PlayerPrefs.SetInt(HOST_PORT_KEY, port);
    PlayerPrefs.Save(); // –í–∞–∂–Ω–æ!
}
```

## üîß –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è:

### 1. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫ —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ –ø–æ—Ä—Ç–∞:
```csharp
private int FindAvailablePort() {
    for (int port = 7777; port < 7800; port++) {
        if (IsPortAvailable(port)) return port;
    }
    return UnityEngine.Random.Range(8000, 9000);
}
```

### 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –ø–æ—Ä—Ç–∞:
```csharp
private bool IsPortAvailable(int port) {
    try {
        var listener = new TcpListener(IPAddress.Any, port);
        listener.Start();
        listener.Stop();
        return true;
    } catch {
        return false;
    }
}
```

### 3. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ:
```csharp
public override void Start() {
    // –û—á–∏—â–∞–µ–º —Å—Ç–∞—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ
    if (!HasActiveHost()) {
        ClearHostData();
    }
}
```

## üß™ –ö–∞–∫ —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç:

### –≠–∫–∑–µ–º–ø–ª—è—Ä 1 (–•–æ—Å—Ç):
```
üöÄ –°–¢–ê–†–¢ –õ–û–ö–ê–õ–¨–ù–û–ì–û –ú–ï–ù–ï–î–ñ–ï–†–ê. –ê–∫—Ç–∏–≤–Ω—ã–π —Ö–æ—Å—Ç: False
üîç –ü–û–ò–°–ö –•–û–°–¢–ê: hasActiveHost = False, hostIP = '', port = 7777
üéÆ –ù–ï –ù–ê–ô–î–ï–ù –•–û–°–¢ - –°–¢–ê–ù–û–í–ò–ú–°–Ø –•–û–°–¢–û–ú
üîç –ù–ê–ô–î–ï–ù –°–í–û–ë–û–î–ù–´–ô –ü–û–†–¢: 7777
üíæ –°–û–•–†–ê–ù–ï–ù–´ –î–ê–ù–ù–´–ï –•–û–°–¢–ê: localhost:7777
üéâ –õ–û–ö–ê–õ–¨–ù–´–ô –•–û–°–¢ –°–û–ó–î–ê–ù –£–°–ü–ï–®–ù–û!
```

### –≠–∫–∑–µ–º–ø–ª—è—Ä 2 (–ö–ª–∏–µ–Ω—Ç):
```
üöÄ –°–¢–ê–†–¢ –õ–û–ö–ê–õ–¨–ù–û–ì–û –ú–ï–ù–ï–î–ñ–ï–†–ê. –ê–∫—Ç–∏–≤–Ω—ã–π —Ö–æ—Å—Ç: True
üîç –ü–û–ò–°–ö –•–û–°–¢–ê: hasActiveHost = True, hostIP = 'localhost', port = 7777
üéØ –ù–ê–ô–î–ï–ù –õ–û–ö–ê–õ–¨–ù–´–ô –•–û–°–¢: localhost:7777
üîå –ü–û–î–ö–õ–Æ–ß–ê–ï–ú–°–Ø –ö –•–û–°–¢–£: localhost:7777
üéØ –ö–õ–ò–ï–ù–¢ –ü–û–î–ö–õ–Æ–ß–ï–ù –ö –•–û–°–¢–£
üéâ –ò–ì–†–ê –ù–ê–ß–ê–õ–ê–°–¨ - –û–ë–ê –ò–ì–†–û–ö–ê –í –°–ë–û–†–ï!
```

## üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç:

‚úÖ **PlayerPrefs —Ä–∞–±–æ—Ç–∞—é—Ç –º–µ–∂–¥—É —ç–∫–∑–µ–º–ø–ª—è—Ä–∞–º–∏**  
‚úÖ **–ü–µ—Ä–≤—ã–π —ç–∫–∑–µ–º–ø–ª—è—Ä —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è —Ö–æ—Å—Ç–æ–º**  
‚úÖ **–í—Ç–æ—Ä–æ–π —ç–∫–∑–µ–º–ø–ª—è—Ä –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫–∞–∫ –∫–ª–∏–µ–Ω—Ç**  
‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫ —Å–≤–æ–±–æ–¥–Ω—ã—Ö –ø–æ—Ä—Ç–æ–≤**  
‚úÖ **–ü–æ–¥—Ä–æ–±–Ω—ã–µ –ª–æ–≥–∏ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏**  

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:

1. –ó–∞–º–µ–Ω–∏—Ç–µ `SimpleRelayManager` –Ω–∞ `LocalTestManager`
2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ Multiplayer Play Mode (2 –∏–≥—Ä–æ–∫–∞)
3. –í –ø–µ—Ä–≤–æ–º –æ–∫–Ω–µ –Ω–∞–∂–º–∏—Ç–µ "–°—Ç–∞—Ä—Ç" ‚Üí –¥–æ–ª–∂–µ–Ω —Å—Ç–∞—Ç—å —Ö–æ—Å—Ç–æ–º
4. –í–æ –≤—Ç–æ—Ä–æ–º –æ–∫–Ω–µ –Ω–∞–∂–º–∏—Ç–µ "–°—Ç–∞—Ä—Ç" ‚Üí –¥–æ–ª–∂–µ–Ω –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫–∞–∫ –∫–ª–∏–µ–Ω—Ç
5. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Console - –¥–æ–ª–∂–Ω—ã –ø–æ—è–≤–∏—Ç—å—Å—è –ª–æ–≥–∏ —Å —ç–º–æ–¥–∑–∏

## üí° –í–∞–∂–Ω–æ:

- **PlayerPrefs.Save()** –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –ø–æ—Å–ª–µ –∑–∞–ø–∏—Å–∏
- **–û—á–∏—Å—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö** –ø—Ä–∏ –æ—Å—Ç–∞–Ω–æ–≤–∫–µ —Ö–æ—Å—Ç–∞
- **–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Ä—Ç–æ–≤** –¥–ª—è –∏–∑–±–µ–∂–∞–Ω–∏—è –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤

**–¢–µ–ø–µ—Ä—å LocalTestManager –¥–æ–ª–∂–µ–Ω —Ä–∞–±–æ—Ç–∞—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –≤ Unity Editor!** üöÄ
